<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Binaural Beats Generator for Concentration</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
        }
        .controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        label {
            font-weight: bold;
        }
        .slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        input[type="range"] {
            flex-grow: 1;
        }
        .value-display {
            min-width: 60px;
            text-align: right;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        button:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
        .preset-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        .preset-button {
            flex: 1 1 calc(33% - 10px);
            min-width: 120px;
            background-color: #2ecc71;
        }
        .preset-button:hover {
            background-color: #27ae60;
        }
        .info {
            margin-top: 30px;
            padding: 15px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .frequency-info {
            margin-top: 10px;
        }
        .waveform-container {
            position: relative;
            height: 100px;
            background-color: #ecf0f1;
            border-radius: 5px;
            overflow: hidden;
            margin: 20px 0;
        }
        .waveform {
            position: absolute;
            width: 100%;
            height: 100%;
        }
        #volume-slider {
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Binaural Beats Generator</h1>
        <div class="waveform-container">
            <canvas id="waveform" class="waveform"></canvas>
        </div>
        <div class="controls">
            <div class="control-group">
                <label for="carrier-frequency">Carrier Frequency (Hz)</label>
                <div class="slider-container">
                    <input type="range" id="carrier-frequency" min="100" max="500" value="250" step="1">
                    <span id="carrier-value" class="value-display">250 Hz</span>
                </div>
            </div>
            <div class="control-group">
                <label for="beat-frequency">Beat Frequency (Hz)</label>
                <div class="slider-container">
                    <input type="range" id="beat-frequency" min="0.5" max="30" value="10" step="0.1">
                    <span id="beat-value" class="value-display">10 Hz</span>
                </div>
            </div>
            <div class="control-group">
                <label for="volume-slider">Volume</label>
                <div class="slider-container">
                    <input type="range" id="volume-slider" min="0" max="1" value="0.5" step="0.01">
                    <span id="volume-value" class="value-display">50%</span>
                </div>
            </div>
            <button id="play-pause">Start</button>
            
            <h3>Concentration Presets</h3>
            <div class="preset-buttons">
                <button class="preset-button" data-carrier="250" data-beat="10">Alpha (10 Hz)<br>Relaxed Focus</button>
                <button class="preset-button" data-carrier="250" data-beat="15">Beta (15 Hz)<br>Active Focus</button>
                <button class="preset-button" data-carrier="250" data-beat="6">Theta (6 Hz)<br>Deep Focus</button>
            </div>
        </div>
        
        <div class="info">
            <h3>Brainwave Frequencies for Concentration</h3>
            <p>Different frequency ranges correspond to different mental states:</p>
            <ul class="frequency-info">
                <li><strong>Alpha (8-12 Hz):</strong> Relaxed focus, calmness, present moment awareness</li>
                <li><strong>Beta (12-30 Hz):</strong> Active thinking, focus, alert, analytical problem solving</li>
                <li><strong>Theta (4-8 Hz):</strong> Deep meditation, creativity, insight</li>
            </ul>
            <p>For optimal concentration, alpha and low beta frequencies (10-15 Hz) are often recommended.</p>
        </div>
    </div>

    <script>
        // Audio context and variables
        let audioContext;
        let oscillatorLeft;
        let oscillatorRight;
        let gainNode;
        let analyser;
        let isPlaying = false;
        let animationId;

        // DOM elements
        const carrierFrequencySlider = document.getElementById('carrier-frequency');
        const beatFrequencySlider = document.getElementById('beat-frequency');
        const volumeSlider = document.getElementById('volume-slider');
        const carrierValue = document.getElementById('carrier-value');
        const beatValue = document.getElementById('beat-value');
        const volumeValue = document.getElementById('volume-value');
        const playPauseButton = document.getElementById('play-pause');
        const presetButtons = document.querySelectorAll('.preset-button');
        const waveformCanvas = document.getElementById('waveform');
        const waveformCtx = waveformCanvas.getContext('2d');

        // Initialize canvas
        function resizeCanvas() {
            waveformCanvas.width = waveformCanvas.offsetWidth;
            waveformCanvas.height = waveformCanvas.offsetHeight;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        // Update value displays
        carrierFrequencySlider.addEventListener('input', updateCarrierValue);
        beatFrequencySlider.addEventListener('input', updateBeatValue);
        volumeSlider.addEventListener('input', updateVolumeValue);

        function updateCarrierValue() {
            const carrierFreq = parseFloat(carrierFrequencySlider.value);
            carrierValue.textContent = `${carrierFreq} Hz`;
            if (isPlaying) {
                updateOscillators();
            }
        }

        function updateBeatValue() {
            const beatFreq = parseFloat(beatFrequencySlider.value);
            beatValue.textContent = `${beatFreq} Hz`;
            if (isPlaying) {
                updateOscillators();
            }
        }

        function updateVolumeValue() {
            const volume = parseFloat(volumeSlider.value);
            volumeValue.textContent = `${Math.round(volume * 100)}%`;
            if (gainNode) {
                gainNode.gain.value = volume;
            }
        }

        // Play/pause button
        playPauseButton.addEventListener('click', togglePlayPause);

        function togglePlayPause() {
            if (isPlaying) {
                stopSound();
                playPauseButton.textContent = 'Start';
            } else {
                startSound();
                playPauseButton.textContent = 'Stop';
            }
        }

        // Preset buttons
        presetButtons.forEach(button => {
            button.addEventListener('click', () => {
                const carrier = parseFloat(button.dataset.carrier);
                const beat = parseFloat(button.dataset.beat);
                
                carrierFrequencySlider.value = carrier;
                beatFrequencySlider.value = beat;
                
                updateCarrierValue();
                updateBeatValue();
                
                if (isPlaying) {
                    updateOscillators();
                }
            });
        });

        // Start binaural beats
        function startSound() {
            try {
                // Create or resume audio context (handling autoplay policy)
                if (!audioContext) {
                    audioContext = new (window.AudioContext || window.webkitAudioContext)();
                } else if (audioContext.state === 'suspended') {
                    audioContext.resume();
                }
                
                // Create nodes
                oscillatorLeft = audioContext.createOscillator();
                oscillatorRight = audioContext.createOscillator();
                gainNode = audioContext.createGain();
                analyser = audioContext.createAnalyser();
                
                // Create stereo panner for separation
                const pannerLeft = audioContext.createStereoPanner();
                const pannerRight = audioContext.createStereoPanner();
                
                pannerLeft.pan.value = -1; // Left
                pannerRight.pan.value = 1; // Right
                
                // Set frequencies
                updateOscillators();
                
                // Set volume
                gainNode.gain.value = parseFloat(volumeSlider.value);
                
                // Connect nodes
                oscillatorLeft.connect(pannerLeft);
                oscillatorRight.connect(pannerRight);
                
                pannerLeft.connect(gainNode);
                pannerRight.connect(gainNode);
                
                gainNode.connect(analyser);
                analyser.connect(audioContext.destination);
                
                // Configure analyser
                analyser.fftSize = 2048;
                
                // Start oscillators
                oscillatorLeft.start();
                oscillatorRight.start();
                
                isPlaying = true;
                
                // Start visualization
                visualize();
            } catch (error) {
                console.error("Error starting audio:", error);
                alert("There was an error starting the audio. Please ensure you're using a supported browser.");
            }
        }

        // Stop binaural beats
        function stopSound() {
            if (oscillatorLeft) {
                oscillatorLeft.stop();
                oscillatorRight.stop();
                
                oscillatorLeft.disconnect();
                oscillatorRight.disconnect();
                
                oscillatorLeft = null;
                oscillatorRight = null;
            }
            
            if (animationId) {
                cancelAnimationFrame(animationId);
                animationId = null;
            }
            
            isPlaying = false;
            
            // Clear waveform
            waveformCtx.clearRect(0, 0, waveformCanvas.width, waveformCanvas.height);
        }

        // Update oscillator frequencies
        function updateOscillators() {
            if (!oscillatorLeft || !oscillatorRight) return;
            
            const carrierFreq = parseFloat(carrierFrequencySlider.value);
            const beatFreq = parseFloat(beatFrequencySlider.value);
            
            // Left ear frequency
            const leftFreq = carrierFreq - (beatFreq / 2);
            // Right ear frequency
            const rightFreq = carrierFreq + (beatFreq / 2);
            
            oscillatorLeft.frequency.setValueAtTime(leftFreq, audioContext.currentTime);
            oscillatorRight.frequency.setValueAtTime(rightFreq, audioContext.currentTime);
        }

        // Visualize audio
        function visualize() {
            const bufferLength = analyser.frequencyBinCount;
            const dataArray = new Uint8Array(bufferLength);
            
            function draw() {
                animationId = requestAnimationFrame(draw);
                
                analyser.getByteTimeDomainData(dataArray);
                
                waveformCtx.fillStyle = '#ecf0f1';
                waveformCtx.fillRect(0, 0, waveformCanvas.width, waveformCanvas.height);
                
                waveformCtx.lineWidth = 2;
                waveformCtx.strokeStyle = '#3498db';
                waveformCtx.beginPath();
                
                const sliceWidth = waveformCanvas.width / bufferLength;
                let x = 0;
                
                for (let i = 0; i < bufferLength; i++) {
                    const v = dataArray[i] / 128.0;
                    const y = v * waveformCanvas.height / 2;
                    
                    if (i === 0) {
                        waveformCtx.moveTo(x, y);
                    } else {
                        waveformCtx.lineTo(x, y);
                    }
                    
                    x += sliceWidth;
                }
                
                waveformCtx.lineTo(waveformCanvas.width, waveformCanvas.height / 2);
                waveformCtx.stroke();
            }
            
            draw();
        }

        // Initialize values
        updateCarrierValue();
        updateBeatValue();
        updateVolumeValue();
    </script>
</body>
</html>